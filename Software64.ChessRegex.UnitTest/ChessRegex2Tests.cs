using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;
using NUnit.Framework;

namespace Software64.ChessRegex.UnitTest
{
    [TestFixture]
    public class ChessRegex2Tests
    {
        [Test]
        public void Pawn_move_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "e4", "e4!", "e4!!", "e4?", "e4??", "e4!?", "e4?!",
                "e4+", "e4+!", "e4+!!", "e4+?", "e4+??", "e4+!?", "e4+?!",
                "e4++", "e4#",
            };

            ActAndAssert(ChessRegex2.PawnMoves, expected);
        }

        [Test]
        public void Pawn_promotes_move_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "e8=Q", "e8=Q!", "e8=Q!!", "e8=Q?", "e8=Q??", "e8=Q!?", "e8=Q?!",
                "e8=Q+", "e8=Q+!", "e8=Q+!!", "e8=Q+?", "e8=Q+??", "e8=Q+!?", "e8=Q+?!",
                "e8=Q++", "e8=Q#",
            };

            ActAndAssert(ChessRegex2.PawnPromotes, expected);
        }

        [Test]
        public void Pawn_captures_move_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "dxe4", "dxe4!", "dxe4!!", "dxe4?", "dxe4??", "dxe4!?", "dxe4?!",
                "dxe4+", "dxe4+!", "dxe4+!!", "dxe4+?", "dxe4+??", "dxe4+!?", "dxe4+?!",
                "dxe4++", "dxe4#",
            };

            ActAndAssert(ChessRegex2.PawnCaptures, expected);
        }

        [Test]
        public void Pawn_captures_and_promotes_move_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "dxe8=Q", "dxe8=Q!", "dxe8=Q!!", "dxe8=Q?", "dxe8=Q??", "dxe8=Q!?", "dxe8=Q?!",
                "dxe8=Q+", "dxe8=Q+!", "dxe8=Q+!!", "dxe8=Q+?", "dxe8=Q+??", "dxe8=Q+!?", "dxe8=Q+?!",
                "dxe8=Q++", "dxe8=Q#",
            };

            ActAndAssert(ChessRegex2.PawnCapturesPromotes, expected);
        }

        [Test]
        public void Rook_move_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "Rd1", "Rd1!", "Rd1!!", "Rd1?", "Rd1??", "Rd1!?", "Rd1?!",
                "Rd1+", "Rd1+!", "Rd1+!!", "Rd1+?", "Rd1+??", "Rd1+!?", "Rd1+?!",
                "Rd1++", "Rd1#",
            };

            ActAndAssert(ChessRegex2.RookMoves, expected);
        }

        [Test]
        public void Rook_move_from_file_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "Rad1", "Rad1!", "Rad1!!", "Rad1?", "Rad1??", "Rad1!?", "Rad1?!",
                "Rad1+", "Rad1+!", "Rad1+!!", "Rad1+?", "Rad1+??", "Rad1+!?", "Rad1+?!",
                "Rad1++", "Rad1#",
            };

            ActAndAssert(ChessRegex2.RookMovesFromFile, expected);
        }

        [Test]
        public void Rook_move_from_rank_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "R5d1", "R5d1!", "R5d1!!", "R5d1?", "R5d1??", "R5d1!?", "R5d1?!",
                "R5d1+", "R5d1+!", "R5d1+!!", "R5d1+?", "R5d1+??", "R5d1+!?", "R5d1+?!",
                "R5d1++", "R5d1#",
            };

            ActAndAssert(ChessRegex2.RookMovesFromRank, expected);
        }

        [Test]
        public void Rook_captures_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "Rxd1", "Rxd1!", "Rxd1!!", "Rxd1?", "Rxd1??", "Rxd1!?", "Rxd1?!",
                "Rxd1+", "Rxd1+!", "Rxd1+!!", "Rxd1+?", "Rxd1+??", "Rxd1+!?", "Rxd1+?!",
                "Rxd1++", "Rxd1#",
            };

            ActAndAssert(ChessRegex2.RookCaptures, expected);
        }

        [Test]
        public void Rook_captures_from_file_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "Raxd1", "Raxd1!", "Raxd1!!", "Raxd1?", "Raxd1??", "Raxd1!?", "Raxd1?!",
                "Raxd1+", "Raxd1+!", "Raxd1+!!", "Raxd1+?", "Raxd1+??", "Raxd1+!?", "Raxd1+?!",
                "Raxd1++", "Raxd1#",
            };

            ActAndAssert(ChessRegex2.RookCapturesFromFile, expected);
        }

        [Test]
        public void Rook_captures_from_rank_test()
        {
            // Arrange
            var expected = new List<string>
            {
                "R5xd1", "R5xd1!", "R5xd1!!", "R5xd1?", "R5xd1??", "R5xd1!?", "R5xd1?!",
                "R5xd1+", "R5xd1+!", "R5xd1+!!", "R5xd1+?", "R5xd1+??", "R5xd1+!?", "R5xd1+?!",
                "R5xd1++", "R5xd1#",
            };

            ActAndAssert(ChessRegex2.RookCapturesFromRank, expected);
        }

        private static void ActAndAssert(string pattern, List<string> expected)
        {
            // Act
            var actual = TestFixture.MoveExamples.Where(move => Regex.IsMatch(move, pattern)).ToList();

            // Assert
            CollectionAssert.AreEqual(expected, actual);
        }
    }
}
